<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Simpel BO3 Bracket</title>
<style>
    body { font-family: Arial; background: #f2f2f2; padding: 20px; }
    h1 { margin-bottom: 20px; }
    .row { display: flex; gap: 40px; }
    .round { width: 220px; }
    .match {
        background: white;
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 25px;
        box-shadow: 0 0 5px rgba(0,0,0,0.15);
    }
    input { width: 40px; padding: 5px; margin: 3px; }
    .slot {
        margin-top: 10px;
        padding: 6px;
        background: #e8e8e8;
        border-radius: 6px;
        font-weight: bold;
        text-align: center;
    }
</style>
</head>
<body>

<h1>BO3 Bracket – Eindscore systeem (2–0 of 2–1)</h1>

<div class="row">
    <div class="round" id="r1"></div>
    <div class="round" id="r2"></div>
    <div class="round" id="r3"></div>
</div>

<script>
let players = [
    "Player 1","Player 2",
    "Player 3","Player 4",
    "Player 5","Player 6",
    "Player 7","Player 8"
];

let winnersR1 = ["","","",""];
let winnersR2 = ["",""];
let winnerFinal = "";

// --------------------------
// BO3 CHECKER (simpel)
// --------------------------
function decideWinner(round, index, aName, bName, targetArr, nextIndex) {
    let a = Number(document.getElementById(round+index+"a").value || 0);
    let b = Number(document.getElementById(round+index+"b").value || 0);

    let output = document.getElementById(round+index+"slot");

    if (a < 2 && b < 2) {
        output.innerHTML = "Not decided yet";
        targetArr[nextIndex] = "";
        return;
    }

    if (a === b) {
        output.innerHTML = "Not decided yet";
        targetArr[nextIndex] = "";
        return;
    }

    if (a > b) {
        output.innerHTML = aName;
        targetArr[nextIndex] = aName;
    } else {
        output.innerHTML = bName;
        targetArr[nextIndex] = bName;
    }

    updateBracket();
}

// --------------------------
// MATCH GENERATOR
// --------------------------
function match(pA, pB, round, index) {
    return `
        <div class="match">
            <b>${pA}</b><br>
            Score: <input id="${round}${index}a" type="number" min="0" max="2"> <br><br>

            <b>${pB}</b><br>
            Score: <input id="${round}${index}b" type="number" min="0" max="2">

            <div id="${round}${index}slot" class="slot">Not decided yet</div>
        </div>
    `;
}

// --------------------------
// BRACKET TEKENEN
// --------------------------
function updateBracket() {
    // ROUND 1
    let r1 = document.getElementById("r1");
    r1.innerHTML = "";
    for (let i=0; i<4; i++) {
        let pA = players[i*2];
        let pB = players[i*2+1];
        r1.innerHTML += match(pA, pB, "r1", i);
    }

    // ROUND 2
    let r2 = document.getElementById("r2");
    r2.innerHTML = "";
    for (let i=0; i<2; i++) {
        let pA = winnersR1[i*2] || "Winner Match "+(i*2+1);
        let pB = winnersR1[i*2+1] || "Winner Match "+(i*2+2);
        r2.innerHTML += match(pA, pB, "r2", i);
    }

    // FINAL
    let r3 = document.getElementById("r3");
    r3.innerHTML = "";
    let pA = winnersR2[0] || "Winner Semi 1";
    let pB = winnersR2[1] || "Winner Semi 2";
    r3.innerHTML += match(pA, pB, "r3", 0);

    // KOPPEL INPUT EVENTS
    for (let i=0; i<4; i++) {
        let A = players[i*2];
        let B = players[i*2+1];
        ["a","b"].forEach(s => {
            document.getElementById("r1"+i+s).addEventListener("input", () => {
                decideWinner("r1", i, A, B, winnersR1, Math.floor(i/2));
            });
        });
    }

    for (let i=0; i<2; i++) {
        ["a","b"].forEach(s => {
            document.getElementById("r2"+i+s).addEventListener("input", () => {
                let A = winnersR1[i*2] || "Winner Match "+(i*2+1);
                let B = winnersR1[i*2+1] || "Winner Match "+(i*2+2);
                decideWinner("r2", i, A, B, winnersR2, i);
            });
        });
    }

    ["a","b"].forEach(s => {
        document.getElementById("r30"+s).addEventListener("input", () => {
            let A = winnersR2[0] || "Winner Semi 1";
            let B = winnersR2[1] || "Winner Semi 2";
            decideWinner("r3", 0, A, B, [winnerFinal], 0);
        });
    });
}

updateBracket();
</script>

</body>
</html>
